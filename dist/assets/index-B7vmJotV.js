import{r as e,j as a}from"./index-DGhEqDkt.js";import{H as s}from"./Header-BhW7t8b_.js";import"./wharfkit-core-BkQ8BilC.js";import"./utils-DW7bVyUt.js";import"./react-vendor-BLTrkT9p.js";import"./wharfkit-wallets-DzpnuXri.js";const t=({session:t,selectedNetwork:n,resourceBalances:l,mobileMenuOpen:o,onNetworkChange:i,onMobileMenuToggle:c,onLogout:r,onNavigate:d,onDeposit:m,onWithdraw:h})=>{const[p,u]=e.useState("swap"),[w,b]=e.useState(""),[x,j]=e.useState("HUNY"),[y,g]=e.useState({HUNY:"",PLN:"",BWAX:"",RJ:""}),[N,f]=e.useState([]),[v,k]=e.useState(!1),[S,F]=e.useState(!1),[W,A]=e.useState(!1),[B,C]=e.useState(null),[H,P]=e.useState(null),L=[{symbol:"HUNY",name:"Honey",contract:"farminghoney"},{symbol:"PLN",name:"Pollen",contract:"farminghoney"},{symbol:"BWAX",name:"Beeswax",contract:"farminghoney"},{symbol:"RJ",name:"Royal Jelly",contract:"farminghoney"}];e.useEffect(()=>{"deposit"===p&&(async()=>{if(t){k(!0);try{const a=[];for(const s of L)try{const e=await t.client.v1.chain.get_currency_balance(s.contract,t.actor.toString(),s.symbol),n=e.length>0?parseFloat(e[0].toString().split(" ")[0]):0;a.push({symbol:s.symbol,amount:n,contract:s.contract})}catch(e){console.warn(`Failed to fetch ${s.symbol} balance:`,e),a.push({symbol:s.symbol,amount:0,contract:s.contract})}f(a)}catch(e){console.error("Failed to fetch wallet balances:",e)}finally{k(!1)}}})()},[p,t]);const U=e=>{const a=l.find(a=>a.resource_name===e);return a?parseFloat(a.amount.toString()):0},$=e=>{const a=N.find(a=>a.symbol===e);return a?a.amount:0},E=async()=>{if(!w||parseFloat(w)<=0)C("Please enter a valid deposit amount");else{F(!0),C(null),P(null);try{await m(x,w),P(`Successfully deposited ${w} ${x}`),b("")}catch(e){C(`Failed to deposit: ${e instanceof Error?e.message:"Unknown error"}`)}finally{F(!1)}}},M=async()=>{const e=parseFloat(y.HUNY)||0,a=parseFloat(y.PLN)||0,s=parseFloat(y.BWAX)||0,t=parseFloat(y.RJ)||0;if(e+a+s+t<=0)C("Please enter at least one withdrawal amount");else if(e>U("HUNY")||a>U("PLN")||s>U("BWAX")||t>U("RJ"))C("Insufficient balance for withdrawal");else{A(!0),C(null),P(null);try{await h(e,a,s,t),P("Successfully withdrew tokens"),g({HUNY:"",PLN:"",BWAX:"",RJ:""})}catch(n){C(`Failed to withdraw: ${n instanceof Error?n.message:"Unknown error"}`)}finally{A(!1)}}};return a.jsxs("div",{className:"App wallet",children:[a.jsx(s,{session:t,selectedNetwork:n,resourceBalances:l,mobileMenuOpen:o,onNetworkChange:i,onMobileMenuToggle:c,onLogout:r,onNavigate:d,currentPage:"wallet"}),a.jsx("div",{className:"wallet-content",children:a.jsxs("div",{className:"wallet-container",children:[a.jsx("h2",{children:"ðŸ’° Wallet Management"}),B&&a.jsx("div",{className:"error-message",children:B}),H&&a.jsx("div",{className:"success-message",children:H}),a.jsxs("div",{className:"balance-section compact",children:[a.jsx("h3",{children:"Current Game Balances"}),a.jsx("div",{className:"balance-grid compact",children:L.map(e=>a.jsxs("div",{className:"balance-item compact",children:[a.jsxs("span",{className:"token-name",children:[e.name," (",e.symbol,")"]}),a.jsx("span",{className:"token-amount",children:U(e.symbol).toFixed(4)})]},e.symbol))})]}),a.jsxs("div",{className:"tab-navigation centered",children:[a.jsx("button",{className:"tab-btn "+("swap"===p?"active":""),onClick:()=>u("swap"),children:"ðŸ”„ Swap"}),a.jsx("button",{className:"tab-btn "+("deposit"===p?"active":""),onClick:()=>u("deposit"),children:"ðŸ“¥ Deposit"}),a.jsx("button",{className:"tab-btn "+("withdraw"===p?"active":""),onClick:()=>u("withdraw"),children:"ðŸ“¤ Withdraw"})]}),a.jsx("div",{className:"tab-content",children:(()=>{switch(p){case"swap":const e="mainnet"===n?"http://wax.alcor.exchange/swap-widget":"http://waxtest.alcor.exchange/swap-widget";return a.jsxs("div",{className:"swap-section",children:[a.jsx("h3",{children:"Token Swap"}),a.jsx("p",{className:"section-description",children:"Swap tokens directly within the app using Alcor Exchange."}),a.jsx("div",{className:"swap-iframe-container",children:a.jsx("iframe",{src:e,width:"100%",height:"600",frameBorder:"0",title:"Alcor Exchange Swap Widget",className:"swap-iframe"})})]});case"deposit":return a.jsxs("div",{className:"deposit-section",children:[a.jsx("h3",{children:"Deposit Tokens"}),a.jsx("p",{className:"section-description",children:"Deposit tokens from your wallet to the game contract for use in farming activities."}),a.jsxs("div",{className:"wallet-balances",children:[a.jsx("h4",{children:"Your Wallet Balances"}),v?a.jsx("div",{className:"loading-balances",children:"Loading wallet balances..."}):a.jsx("div",{className:"balance-grid",children:L.map(e=>a.jsxs("div",{className:"wallet-balance-item",children:[a.jsxs("span",{className:"token-name",children:[e.name," (",e.symbol,")"]}),a.jsx("span",{className:"token-amount",children:$(e.symbol).toFixed(4)})]},e.symbol))})]}),a.jsxs("div",{className:"deposit-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"deposit-token",children:"Token:"}),a.jsx("select",{id:"deposit-token",value:x,onChange:e=>j(e.target.value),children:L.map(e=>a.jsxs("option",{value:e.symbol,children:[e.name," (",e.symbol,") - Available: ",$(e.symbol).toFixed(4)]},e.symbol))})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"deposit-amount",children:"Amount:"}),a.jsx("input",{id:"deposit-amount",type:"number",step:"0.0001",min:"0",max:$(x),value:w,onChange:e=>b(e.target.value),placeholder:"Enter amount to deposit"})]}),a.jsx("button",{className:"deposit-btn",onClick:E,disabled:S||!w||0===$(x),children:S?"Depositing...":"Deposit"})]})]});case"withdraw":return a.jsxs("div",{className:"withdraw-section",children:[a.jsx("h3",{children:"Withdraw Tokens"}),a.jsx("p",{className:"section-description",children:"Withdraw tokens from the game contract back to your wallet."}),a.jsxs("div",{className:"withdraw-form",children:[L.map(e=>a.jsxs("div",{className:"form-group",children:[a.jsxs("label",{htmlFor:`withdraw-${e.symbol}`,children:[e.name," (",e.symbol,") - Available: ",U(e.symbol).toFixed(4)]}),a.jsx("input",{id:`withdraw-${e.symbol}`,type:"number",step:"0.0001",min:"0",max:U(e.symbol),value:y[e.symbol],onChange:a=>((e,a)=>{g(s=>({...s,[e]:a}))})(e.symbol,a.target.value),placeholder:`Enter ${e.symbol} amount`})]},e.symbol)),a.jsx("button",{className:"withdraw-btn",onClick:M,disabled:W,children:W?"Withdrawing...":"Withdraw"})]})]});default:return null}})()})]})})]})};export{t as default};
